package user;

import java.security.NoSuchAlgorithmException;
import java.security.spec.InvalidKeySpecException;
import java.util.Scanner;



public class UserRegister {
	
	public void register(Scanner sc) throws NoSuchAlgorithmException, InvalidKeySpecException {
		System.out.println("welcome to register");
		System.out.println("type id");
		String id = sc.nextLine();
		CheckDuplicationService cd = new CheckDuplicationService();
		while(cd.checkId(id)) {
            System.out.println("Duplicate id! Type another");
            id = sc.nextLine();
        }
        System.out.println("ID is available.");
		//암호화 로직
		System.out.println("type password");
		String password = sc.nextLine();
		String encryptedPassword = PasswordEncryption.encryptPassword(password);

		
		System.out.println("type nickName");
		String nickName = sc.nextLine();
		while(cd.checkNickName(nickName)) {
            System.out.println("Duplicate nickName! Type another");
            nickName = sc.nextLine();
        }
        System.out.println("nickName is available.");
		
		User user = new User(id, nickName, encryptedPassword);
		UserRegisterationService usv = new UserRegisterationService();
		usv.registerUser(user);
		
		System.out.println("registeration complete!");
		System.out.println("go back to main page");
	}
	
}
