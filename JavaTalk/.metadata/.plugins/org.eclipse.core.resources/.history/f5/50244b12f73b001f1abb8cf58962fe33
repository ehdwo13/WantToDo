package user;

import java.security.NoSuchAlgorithmException;
import java.security.spec.InvalidKeySpecException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import config.DatabaseConnection;

public class UserLoginService {
	
	public String match(String id, String password) throws NoSuchAlgorithmException, InvalidKeySpecException {
		 String sql = "SELECT PASSWORD FROM USER WHERE ID = ?";
		    try (Connection connection = DatabaseConnection.getConnection();
		         PreparedStatement preparedStatement = connection.prepareStatement(sql)) {

		        preparedStatement.setString(1, id);

		        try (ResultSet resultSet = preparedStatement.executeQuery()) {
		            if (resultSet.next()) {
		                String storedPassword = resultSet.getString("PASSWORD");
		                boolean matchResult = PasswordEncryption.matchPassword(storedPassword, password);
		                System.out.println("확인결과 " +matchResult);
		                if (matchResult) {
		                    return "pass";
		                } else {
		                    return "wrongPassword";
		                }
		            } else {
		                return "wrongId";
		            }
		        }
		    } catch (SQLException e) {
		        e.printStackTrace();
		    }
		    return "method Error";
	}

}
